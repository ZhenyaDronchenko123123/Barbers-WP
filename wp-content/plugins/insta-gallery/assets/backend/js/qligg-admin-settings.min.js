!function($){"use strict";function ig_change_spinner(link){if(link){if($("#qligg-save-settings .insta-gallery-spinner img").length)$("#qligg-save-settings .insta-gallery-spinner img").attr("src",link);else{var img='<img src="'+link+'" class="ig-spin" />';$("#qligg-save-settings .insta-gallery-spinner").append(img)}$("#qligg-save-settings .insta-gallery-spinner .ig-spin").hide(),$("#qligg-save-settings .insta-gallery-spinner img").show()}else $("#qligg-save-settings .insta-gallery-spinner .ig-spin").show(),$("#qligg-save-settings .insta-gallery-spinner img").remove()}_.mixin({escapeHtml:function(attribute){return attribute.replace("&amp;",/&/g).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#039;/g,"'")},getFormData:function($form){return $form.serializeJSON()}});var $igs_image_id=$("input[name=insta_spinner_image_id]"),$igs_reset=$("#ig-spinner-reset");$("#qligg-save-settings").on("submit",(function(e){e.preventDefault();var $form=$(this),$spinner=$form.find(".spinner");$.ajax({url:ajaxurl,type:"post",dataType:"JSON",data:{action:"qligg_save_settings",nonce:qligg_settings.nonce.qligg_save_settings,settings_data:$form.serialize()},beforeSend:function(){$spinner.addClass("is-active")},success:function(response){},complete:function(){$spinner.removeClass("is-active")},error:function(jqXHR,textStatus){console.log(textStatus)}})})),$igs_reset.on("click",(function(){$igs_image_id.val(""),ig_change_spinner(),$(this).hide()})),""==$igs_image_id.val()&&$igs_reset.hide(),""!=$igs_image_id.data("misrc")&&ig_change_spinner($igs_image_id.data("misrc")),$("#ig-spinner-upload").on("click",(function(e){var image_frame;e.preventDefault(),image_frame&&image_frame.open(),(image_frame=wp.media({title:"Select Media",multiple:!1,library:{type:"image"}})).on("close",(function(){var selection=image_frame.state().get("selection");if(selection.length){var gallery_ids=new Array,i=0,attachment_url;selection.each((function(attachment){gallery_ids[i]=attachment.id,attachment_url=attachment.attributes.url,i++}));var ids=gallery_ids.join(",");$igs_image_id.val(ids),ig_change_spinner(attachment_url)}""==$igs_image_id.val()?$igs_reset.hide():$igs_reset.show()})),image_frame.on("open",(function(){var selection=image_frame.state().get("selection"),ids;$igs_image_id.val().split(",").forEach((function(id){attachment=wp.media.attachment(id),attachment.fetch(),selection.add(attachment?[attachment]:[])}))})),image_frame.open()}))}(jQuery);